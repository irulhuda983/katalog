import{E as m,r as g,Y as d,ai as p,e as f}from"./index-0UGeHLIg.js";import{a as l}from"./api-YczHc_IR.js";/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=m("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),i=g(!1),n=d({});function D(){return{isOpen:i,dialogProps:n,openDialog:o=>{Object.assign(n,o),i.value=!0},closeDialog:()=>{i.value=!1,Object.keys(n).forEach(o=>delete n[o])}}}const I=p("auth",()=>{const r=g(localStorage.getItem("katalogUserData")?JSON.parse(localStorage.getItem("katalogUserData")):null),a=g(sessionStorage.getItem("katalogAccessToken")||null),o=f(()=>!!a.value),c=t=>{r.value=t,r.value?localStorage.setItem("katalogUserData",JSON.stringify(t)):localStorage.removeItem("katalogUserData")},s=t=>{a.value=t,a.value?sessionStorage.setItem("katalogAccessToken",t):sessionStorage.removeItem("katalogAccessToken")},k=async t=>{try{const{data:e}=await l.post("/auth/login",t);return await Promise.all([s(e.data.accessToken),u()]),e}catch(e){throw e}},h=async t=>{try{const{data:e}=await l.post("/auth/register",t);return await Promise.all([s(e.data.accessToken)]),e}catch(e){throw e}},u=async()=>{if(sessionStorage.getItem("katalogAccessToken"))try{const{data:e}=await l.get("/auth/profil");c(e.data)}catch{s(null),c(null)}};return{user:r,token:a,isAuthenticated:o,setUser:c,setToken:s,login:k,register:h,fetchProfil:u,logout:async()=>{try{const t=await l.post("/auth/logout");s(null),c(null),location.reload()}catch(t){throw t}}}});export{w as L,D as a,I as u};
